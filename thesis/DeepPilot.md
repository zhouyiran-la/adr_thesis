## Abstract

- 使用Deep learning完成无人机竞速更多环节
- 提出Deepilot: 图像 --> CNN --> 控制指令（φ, θ, ψ, h） --> 飞控 --> 自主导航
- 为满足实时性需求，将图像输入替换成mosic，mosic由数张连续图像帧组成

## Introduction

2016年，IEEE-IROS举办举办第一届ADR竞赛，IROS 2016 and 2017竞速方法主要步骤：门检测（传统图像处理方法），定位（视觉SLAM），稳定飞行控制；IROS 2018，Deep Learning开始用于门检测阶段，无人机竞速框架形成：门检测 --> 视觉定位 --> 状态估计 --> 路径规划和控制。2019年末，GoD竞赛开始呼吁利用Deep learning解决更多问题。
基于以上，DeepPilot基于深度卷积神经网络，接收无人机拍摄单目图像生成四个控制指令（φ, θ, ψ, h）。φ：滚转角 ，θ：俯仰角，ψ：偏航角转速，h：垂直速度（高度）。网络结构基于PoseNet改进，网络输从六自由度相机位姿变为无人机控制指令。初次尝试：A Temporal CNN-based Approach for Autonomous Drone Racing，这篇文章重新训练了PoseNet网络，根据单个图像预测φ, θ两个指令。同时，尝试将六张连续图像帧拼接成一张Mosaic作为图像输入，并根据实验结果证明此种方法结果由于普通单图像输入。

## 相关工作

略

## 框架提出

1. 无人机机载摄像头采集图像
2. Mosaic生成（每五个图像帧更新一次）
3. 利用DeepPilot预测控制指令
4. 平滑输出结果

### DeepPilot

- ==研究空间1==：A Temporal CNN-based Approach for Autonomous Drone Racing中网络输出仅仅预测了两个指令（φ, θ），但这项工作中竞速赛道为之字形赛道（zigzag tracks），障碍门高度一致且与拍摄平面平行，故没有必要预测ψ, h两个指令
- ==研究空间2==：简化网络结构。
	-  网络结构主要模块为Inception modules
	-  利用回归器评估飞行指令预测情况（若输出层能够预测出明确指令，回归器会有更好的性能）
	-  DeepPilot共有三个网络分支。第一个网络分支预测φ, θ，第二个分支预测ψ，第三个分支预测h，每个分支网络结构完全相同（仅权重不同）
 以上实现了四指令预测，φ, θ, ψ, h皆在\[-1,1]区间。
 
###  数据集获取

手动控制飞机分别在两个赛道飞行，赛道中门的位置，高度，朝向皆为任意。数据集希望DeepPilot学习到七种动作：横向运动（左右两个方向）、前进、旋转运动（顺时针逆时针两个方向）、垂直运动（上下两个方向），每张图片都会记录一条(φ, θ, ψ, h)指令（图片拍摄时飞机的控制指令）。指令被记录之后并不会直接作为标签使用，需要经过手动调整：人工辨认出每张图片中主导无人机运动的指令，保留该指令值，其余三个值设为0，这一操作的主要目的是避免模糊指令。

共采集到14,900张图片，13,050张作为训练集，1850张作为验证集。训练数据将会分成三个子数据集，分别用于训练网络的三个分支。

### Mosaic生成

多张图片作为CNN输入在Deep Learning中十分常见，但这会带来卷积层冗余、网络参数过多等问题，最终会导致推理时间增加，于是提出Mosaic方法，即将多张连续图片帧拼接在一起作为单张图像输入，其认为连续图像可以反映无人机运动趋势，而这可以被网络学习到，有助于结果预测。

为评估Mosaic方法的效果，根据上述子数据集重新生成四个新数据集：分别由2,4,6,8个图像帧组成一个Mosaic，每五帧更新一次，先进先出。

### 噪声滤波

在将预测指令转发给无人机之前，利用EMA滤波器平滑预测结果。

### 结果与讨论

- 展示在验证集上DeepPilot与gt的均方误差
- 修改A Temporal CNN-based Approach for Autonomous Drone Racing中PoseNet网络，使其也能预测四个飞行指令，并用之字形赛道与DeepPilot做对比。
- 评估得出Mosaic由6个图像帧组成时效果最好。
 

