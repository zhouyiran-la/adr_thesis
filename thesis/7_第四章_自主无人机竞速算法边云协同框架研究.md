### 4.1 边云协同概念阐述

边云协同是指将云端计算和边缘计算相结合，以实现数据处理、分析和决策快速响应与高可靠性的计算模式。在传统的云计算架构中，大多数计算任务都是在云端进行处理，然后将结果返回给终端设备。然而，某些应用场景下（如实时视频流处理、物联网或其他移动设备数据分析等），终端设备所处环境往往网络信号覆盖度低且数据体量大，在此类问题中云计算模式容易产生网络延迟和带宽占用等问题，导致数据实时性与准确性降低，从而影响用户体验。为解决上述问题，边云协同将云计算与边缘计算优势相结合，此时计算资源移动至更靠近数据源的边缘设备，网络延迟大福降低保证了计算结果的实时反馈，于此同时也可以借助云端节点的计算与存储资源。例如，在处理视频流任务中，可以考虑将部分计算工作部署与摄像头或视频录像机等边缘设备上，边端设备只需执行图像分割、运动检测等简单计算任务，之后再将预处理后的数据传输至云端进行更复杂和高级的计算（如人脸识别、物体跟踪等）。通过边云协同此类分布式计算模式，可以在保证应用程序准确性与实时性的同时，减少网络带宽和终端响应延迟所带来的影响。与传统的云计算架构不同，边云协同框架需要考虑更多复杂问题，例如，如何协调分布式计算任务，如何处理边缘设备的限制性资源，如何保证传输数据的安全性和隐私性等等。此外，边云协同与人工智能领域联系紧密，两者彼此耦合，协同发展。一方面，人工智能领域可以为边协同框架中计算卸载、网络服务部署等约束优化问题提供多元解决方案；另一方面，边云协同可以为人工智能技术提供更加广阔的应用平台，如云边大小模型协同推理、边云协同终身学习等。总之，边云协同作为一种新兴计算框架，将云端技术与边缘计算相结合，使得数据处理和分析过程更加实时、高效和安全。在物联网、智能交通、机器人控制等各个领域都有研究与应用价值。

本文第三章中提出可以利用边缘AI加速设备帮助边端无人机独立完成深度学习类自主竞速算法，基于上述陈述，可以考虑将边云协同这一基本构想进一步扩展至自主无人机竞速领域。具体来说，在边云协同框架下，边缘无人机节点可以与云端进行互动，借助云端算力进一步更新完善边缘竞速模型，本文在4.2.1中将基于现有边云协同解决方案设计自主无人机竞速框架。

### 4.2 基于增量学习的边云协同式无人机自主竞速方法设计

#### 4.2.1 KubeEdge-Sedna框架介绍

KubeEdge华为云原生基于Kubernetes（K8s）开发的一个开源边缘计算解决方案，其中Kubernetes是由Google团队发起并维护开源容器集群管理系统，它提供大量工具与API方便用户调度容器资源以实现各种应用功能。除原生支持kubernetes集群外，KubeEdge将云端容器化应用程序和边缘设备集成在一起，简单来说，KubeEdge对Kubernetes进行了扩展和优化，能够使Kubernetes具备在边缘场景下处理问题的能力，实现在边缘节点上编排应用程序、管理终端设备、查询设备状态和监控应用程序和功能。KubeEdge由边缘部分与云端部分组成。对于边缘部分，KubeEdge支持在多种边缘设备（传统PC端与各种嵌入式计算平台）上部署Kubernetes集群以运行容器化应用程序。此外，KubeEdge提供了连接边缘设备和云端的网关功能，使得云端和边缘设备可以进行通信，并且还提供了针对边缘设备的数据采集和处理等功能。对于云端部分，KubeEdge对原有Kubernetes功能进行二次开发，能够在云端节点实现对整个边云集群的管理和监控，用户可以在云端部署和管理应用程序，并对边缘节点进行管理。

KubeEdge整体框架如图4-1所示，云端部分主要K8s API server与CloudCore组成，KubeEdge并未对Kubernetes控制面做出修改，用户在KubeEdge中使用kubectl等原生Kubernetes工具北向调用K8s API与在Kubernetes中使用体验一致。CloudCore是KubeEdge自开发组件，原生Kubernetes中工作节点与K8s API之间采用List-Watch通讯机制，而由于边缘场景下网络状况并不稳定，边缘节点与云端节点网络连接长时间断开后会触发List-Watch中Re-list操作以保证边云两端数据一致性，该操作会重新获取边端全部资源对象，若此时边缘节点数目较多，便会对云端控制面造成剧烈带宽冲击。基于这一背景下，Kubedge利用CloudCore实现云边网络增强，即边端不直接与K8s API通信，CloudCore会先调用K8s API获取源数据，进一步通过CloudHub将数据下发至边端（默认采用WebSocket协议），该条云边链路采用轻量化List-Watch机制，而是通过一系列消息可靠性方法来记录边云通信状态，从而避免资源信息重复获取。边缘部分主要组间为EdgeCore，EdgeCore中EdgeHub与上游CloudHub进行交互实现云边通信，Edged是原Kubernetes工作节点中kubelet组件的简化版本，用于实现边缘Pod生命周期管理，支持各类容器运行时接口（CRI）、容器网络接口（CNI）和容器存储接口（CSI）。此外，KubeEdge边端通过Mapper组件能够接入各种物联网终端设备，支持MQTT协议与管控面交互。
\[表4-1]
\[图4-1]
KubeEdge是当前最活跃的云原生边缘计算社区之一，吸引了世界各地的用户和开发者参与并付诸实践。2020年下半年，KubeEdge成立了AI SIG(Special Interest Group)，旨在解决边缘人工智能在实现中面临的挑战，提高其性能和效率。KubeEdge AI SIG将前期边云协同应用于AI场景的优秀实践经验予以固化，并于2020年12月发起了Sedna子项目。Sedna基于KubeEdge提供的边云协同能力，实现了人工智能模型跨边云协同训练和协同推理，并支持如TensorFlow、PyTorch、PaddlePaddle和MindSpore等业界主流人工智能框架，同时Sedna也支持现有人工智能应用程序无缝下沉到边缘，快速实现跨边云增量学习、联邦学习和协同推理等功能，最终达成降低模型成本、提升模型性能和保护数据隐私的效果，Sedna整体框架如图4-2所示。
\[图4-2]
GlobalManager是基于Kubernetes Operator实现的边缘AI控制器。用户通过创建CRD来实现模型和数据集的管理，以及实现边云协同的AI任务管理和跨边云协调。目前支持以下AI任务：增量训练、联邦学习、联合推理和终身学习。其中，增量训练针对小样本和边缘数据异构的问题，模型可以在云端或边缘进行自适应优化，边学边用使模型越来越智能；联邦学习针对数据集规模大、原始数据不出边缘和隐私要求高等困难场景，AI模型在边缘训练，参数在云端聚合，解决了数据孤岛问题；联合推理针对边缘资源需求大或者边侧资源受限等情况，任务可在云端进行，实现整体推理性能的提升；终身学习旨在解决AI应用在边缘落地时所面临的样本基数小、边缘数据异构等难题，通过云端知识库提供记忆功能，使边缘累积样本信息在持续更新的同时实现数据持久化，从而解决传统AI模型灾难性遗忘问题。同时，终身学习结合了增量训练和多任务训练的方式来实现跨时间和跨情景的知识迁移，以便更好地处理未知任务。Worker用于执行训练或推理任务，基于现有AI框架开发训练，不同AI特性对应不同Worker组，Worker可同时部署在边缘或云端，并实现协同工作。LocalController实现增量训练、联邦学习和联合推理模式的本地闭环管理，包括数据集管理、模型管理和AI任务状态同步等。Lib可为应用程序提供边云协同AI特性接口，用户可以通过调用Lib库来实现边云协同式模型训练、推理和评估。

#### 4.2.2 边云协同式无人机自主竞速方法框架设计

随着人工智能领域蓬勃发展，深度学习类无人机自主竞速方法展现出了其固有优势，近几年也涌现出大量研究成果，但无人机等边端设备计算资源、电池容量有限，难以推理复杂深度神经网络模型，传统云计算方式并不适用于无人机自主竞速此类延迟敏感应用场景，这导致大多数深度学习类无人机自主竞速方法难以真正落地。而受益于目前人工智能与边缘计算领域双向联动发展趋势，许多轻量级AI加速计算平台逐步面世，本文第三章中提出了基于RK1808边缘AI加速设备模型部署方案设计，帮助边端无人机独立完成深度学习类自主竞速算法推理过程，但正如1.1中所述，边缘计算与云计算两者并非是相互割裂，此消彼长的关系，边缘计算与云计算在各自领域都有其不可替代的优越性，在无人机竞速场景下，如何利用好云端资源优势对实现自主竞速方法与人工智能技术深度融合至关重要，具体来说，云端节点往往计算资源丰富，无需考虑功耗限制，网络状况稳定，可以承担起模型训练、模型更新、模型评估等复杂计算任务，而边缘无人机节点只需具备一定模型推理能力，便能在保证指令响应速度的同时不断优化资深网络模型，从而帮助无人机高质量完成自主飞行任务，上述过程中需要边云两端协同互动，完成边缘模型下发、模型更新请求等任务。基于 4.2.1中内容，借助KubeEdge边云协同能力与SednaAI特性，本节提出KubeEdge-Sedna框架下边云协同式无人机自主竞速方法设计方案。

\[图4-3] 

图4-3展示了KubeEdge-Sedna框架下边云协同式无人机自主竞速方法框架，无人机边端节点首先会部署一个初始模型，该模型并不要求预测精度与数据集质量，无人机开始竞速任务后边侧节点推理模块（Inference Worker）将会调用该初始模型生成控制指令。无人机在执行竞速任务期间会碰到难例样本（如无人机在某个障碍门前发生碰撞或者出现路线偏移），具体判断标准可以根据Sedna Lib中相关接口进行自定义操作，之后上述难例样本数据将会上传至云端难例存储数据库，进一步，难例数据需要通过外接标注服务或者人工标注方法进行打标。云端Local Controller会依据指定时间监测已打标难例样本数，当样本数目达到指定阈值时，云端Local Controller会通知Global Manager以触发下一轮训练，新模型训练完成后会传递给评估模块（Evaluation Worker），当模型精度满足指定触发策略时，Global Manager捕获到评估状态信息，会将指定模型下发至边端，并通过边端Local Controller通知推理模块进行模型推理，如此重复这一过程，可实现增量学习式模型更新、评估、推理策略。基于以上陈述，本文设计方案主要有以下两点优势：
（1）小样本模型兼容。对于深度学习类无人机自主竞速算法，不论是仿真或者真实场景中，数据采集采集过程往往十分繁琐耗时，上述设计方案中初始数据集可以只包含少量样本，后续难例数据上传后可以进一步扩充训练样本，提升模型精度。
（2）支持难例上云。本次方案中，仅将推理输入中难例数据上传至云端，从而降低数据标注工作量，同时能够减小边端与云端数据传输体量，减少网络带宽占用。


### 4.3 

为验证，

